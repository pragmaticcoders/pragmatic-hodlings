<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Pragmatic Hodlings contracts</title><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.4/semantic.min.css" rel="stylesheet"/><link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAOVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAABMaXEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABlVggfAAAAE3RSTlPkZE7emXPXAMzHihi+QAwqs6mhB70WSgAAAQFJREFUOMuFk1mSwyAMRAUWhH3J/Q8bFikxNp7pn7hKL12qbgGvfwS/T6Utqfgd4DUYAt5qBziAgwwQ8x3I0DQtEFHdgdqBYVEbgPEKRBhqe4Y+R5cugJ0AtA0HgHIFBM1BT4Nm4RfAHCzFiguAhqQekvQ0D+kpajUB8dhFCn1e/ihLdIAWc3nXRTEGKXX+WIFoDP2xfq3We0A3f+WyzAnIM7tU+jZyA5y3/QVyA3xYI70BjkNfy5IsoVlurZtKxsC9g1zLonm1mi/nsoMkA8unFa9luWlgyaLecogdGFd/dMBvHg5iGYBpc7eJOuObXt4BOm0fbyDAwPZtvrxgnS/3AwT9GsisQa84AAAAAElFTkSuQmCC" rel="icon"/><style>@import url(https://fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Mono);@media only screen and (max-width:767px){[class*="computer only"]:not(.mobile),[class*="large screen only"]:not(.mobile),[class*="mobile hidden"],[class*="or lower hidden"],[class*="tablet only"]:not(.mobile),[class*="widescreen only"]:not(.mobile){display:none!important}}@media only screen and (min-width:768px) and (max-width:991px){[class*="computer only"]:not(.tablet),[class*="large screen only"]:not(.tablet),[class*="mobile only"]:not(.tablet),[class*="or lower hidden"]:not(.mobile),[class*="tablet hidden"],[class*="widescreen only"]:not(.tablet){display:none!important}}@media only screen and (min-width:992px) and (max-width:1199px){[class*="computer hidden"],[class*="large screen only"]:not(.computer),[class*="mobile only"]:not(.computer),[class*="or lower hidden"]:not(.tablet):not(.mobile),[class*="tablet only"]:not(.computer),[class*="widescreen only"]:not(.computer){display:none!important}}@media only screen and (min-width:1200px) and (max-width:1919px){[class*="computer only"]:not([class*="large screen"]),[class*="large screen hidden"],[class*="mobile only"]:not([class*="large screen"]),[class*="or lower hidden"]:not(.computer):not(.tablet):not(.mobile),[class*="tablet only"]:not([class*="large screen"]),[class*="widescreen only"]:not([class*="large screen"]){display:none!important}}@media only screen and (min-width:1920px){[class*="computer only"]:not([class*=widescreen]),[class*="large screen only"]:not([class*=widescreen]),[class*="mobile only"]:not([class*=widescreen]),[class*="tablet only"]:not([class*=widescreen]),[class*="widescreen hidden"],[class*="widescreen or lower hidden"]{display:none!important}}.ui.header,.ui.menu,body,h1,h2,h3,h4,h5{font-family:Roboto,sans-serif}pre.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}code{padding:0 .3em}code,pre{font-family:Roboto Mono,monospace;border:1px solid rgba(0,0,0,.05);background:rgba(0,0,0,.01)}code>code,pre>code{border:none;background:none}pre{padding:1em}.vertical.menu .item{overflow:hidden;text-overflow:ellipsis}.vertical.menu .item.active{overflow:visible}.pusher{display:flex;min-height:100vh;flex-direction:column}.pusher>.container:not(.footer){flex:1}.pusher>.footer{height:auto;margin-top:2em}.header code.signature{font-size:.6em}.ui.method-input{max-width:6em;overflow:hidden;text-overflow:ellipsis;text-align:right}.ui.method-input input{background:hsla(0,0%,100%,.7)}.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style></head><body><div id="react-mount"><div style="padding-top:60px;" class="pusher" data-reactroot="" data-reactid="1" data-react-checksum="1128019530"><div class="ui top fixed inverted menu" data-reactid="2"><div class="ui container" data-reactid="3"><a class="header item" href="/pragmatic-hodlings/" data-reactid="4"><!-- react-text: 5 -->Pragmatic Hodlings contracts<!-- /react-text --><div class="ui grey label" data-reactid="6">0.9.0</div></a><div class="item mobile hidden" data-reactid="7">Pragmatic Hodlings contracts allows any organization to distribute it&#x27;s tokens to all members according to their seniority</div><div class="right menu" data-reactid="8"><a class="item" href="/pragmatic-hodlings/docs/MembersBookLib/" data-reactid="9">Contracts</a><a target="_blank" href="https://github.com/pragmaticcoders/pragmatic-hodlings" class="item" data-reactid="10"><i class="home icon" data-reactid="11"></i></a></div></div></div><div class="ui container" data-reactid="12"><div class="markdown" data-reactid="13"><h1 data-reactid="14"></h1><div data-reactid="15"><h1>Pragmatic Hodlings</h1>
<blockquote>
<p>Pragmatic Hodlings contracts allows any organization to distribute it’s
tokens to all members according to their seniority.</p>
</blockquote>
<h3>Contracts</h3>
<ul>
<li><code>PragmaticHodlings</code> - main contract with business logic for token distribution</li>
<li><code>MembersBookLib</code> - library used by main contract for storing members data</li>
<li><code>TransferableToken</code> - token contract interface, compatible with Pragmatic Hodlings</li>
<li><code>TestToken</code> - token contract based on ERC20 interface, used in test</li>
</ul>
<p>Check out this project on <a href="https://pragmaticcoders.github.io/pragmatic-hodlings/">Github Pages</a></p>
<h3>Ownership</h3>
<p>It is highly recommended to use Multisig and/or DAO contracts as owner of Pragmatic
Hodlings contract. That approach will be more transparent and will make actions to be
less dependent on organization leaders.</p>
<p>To transfer ownership from deployer call <code>transferOwnership</code> function passing an address
of new owner.</p>
<h2>Use cases</h2>
<h3>Add and remove a member</h3>
<p><img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/addHodler.png" alt="#addHodler">
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/removeHodler.png" alt="#removeHodler"></p>
<h3>Receive and Settle token</h3>
<p><img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/transferAndSettleToken.png" alt="#receiveAndSettleToken"></p>
<h2>Members</h2>
<p>Owner of contract is allowed to add (no duplicates) and remove members. Each members is
described by it’s ETH address and timestamp related to joining to organization time.
Member data are stored in array of <code>Member</code> structures.</p>
<pre><code class="language-Solidity">struct Member {
   <span class="hljs-built_in"> address </span>account;
    uint64 joinDate;
}
</code></pre>
<h2>Token share calculation</h2>
<p>When owner is calling <code>settleToken</code> function, then available token amount is shared between all members
existing in <code>MembersBook</code>. Member’s share size is directly related to member’s seniority, and is
calculated from the following formula:</p>
<p><img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/shareFormula.gif" alt="sharesFormula"></p>
<p>where
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/a.gif" alt="A"> is shared amount,
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/s.gif" alt="S"> is member seniority,
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/n.gif" alt="n"> is member index and
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/m.gif" alt="m"> is member count</p>
<p>The chart presented below perfectly shows how token shares differ in time and how each member share
depends on it’s seniority and total members count.</p>
<p>It is important to notice that all shares are approaching in time to
<img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/aDivM.gif" alt="aDivM">,
but they will probably never get there. It is a fair enough way to distribute tokens because the
oldest member always get biggest share but also newer members have a chance to get significant share.</p>
<p><img src="https://pragmaticcoders.github.io/pragmatic-hodlings/images/tokenShares.png" alt="tokenShares"></p>
<h2>Settlement gas costs and maximum members count</h2>
<p>After running several tests of gas used by <code>settleToken</code> function we came up with some conclusions. Test were done for Zeppelin ERC20 token implementation, test accounts have never owned tokens, and members count on contract was increasing up to 100.</p>
<p>First of all settlement gas cost increase each time we add new member by average 33 000 gas.
Furthermore a block has a gas limit which is 8 000 000 for now.</p>
<p>If we do the math we get maximum members count for a contract which is 242.<br>
<code>8 000 000 / 33 000 ~ 242</code></p>
<p><em>Warning!</em> <br>
In case of emergency when member count at contract exceed possible limit we should consider this solusions:</p>
<ul>
<li>Create newer version of contract  (e.g. with scenario when member pays for its transfer)</li>
<li>Move all members to new contract</li>
</ul>
<h2>Contributing</h2>
<p>When submitting a bugfix, write a test that exposes the bug and fails before applying
your fix. Submit the test alongside the fix. When submitting a new feature, add tests
that cover the feature.</p>
<p>Usage:</p>
<ul>
<li><code>npm install</code> - install dependencies</li>
<li><code>npm run compile</code> - compile *.ts and *.sol files</li>
<li><code>npm test</code>- run tests</li>
<li><code>npm run format</code> - format TypeScript files</li>
<li><code>npm run lint</code> - run linter</li>
</ul>
<h2>Credits</h2>
<ul>
<li>Project has been initialized with <a href="https://github.com/pragmaticcoders/truffle-ts-generator">TypeScript-Truffle generator</a></li>
<li>MembersBook library based on <a href="https://github.com/SignHash/signhash-contracts">SignHash</a> project</li>
</ul>
<hr>
<p>Licence: <a href="https://opensource.org/licenses/BSD-3-Clause">BSD-3-Clause</a></p>
</div></div></div><div class="ui container footer" data-reactid="16"><div class="ui small top attached compact secondary segment" data-reactid="17"><div class="ui stackable grid" data-reactid="18"><div class="row" data-reactid="19"><div class="six wide column" data-reactid="20"><b data-reactid="21"><!-- react-text: 22 -->© <!-- /react-text --></b><!-- react-text: 23 --> - <!-- /react-text --><!-- react-text: 24 -->BSD-3-Clause<!-- /react-text --><!-- react-text: 25 -->, <!-- /react-text --><!-- react-text: 26 -->2018<!-- /react-text --></div><div class="right aligned ten wide column" data-reactid="27"><!-- react-text: 28 -->Docs built using <!-- /react-text --><b data-reactid="29"><!-- react-text: 30 -->Solidity <!-- /react-text --></b><!-- react-text: 31 --> on <!-- /react-text --><b data-reactid="32">2018-3-27</b></div></div></div></div></div></div></div><script src="/pragmatic-hodlings/bundle.js?t=1522141447550"></script></body></html>